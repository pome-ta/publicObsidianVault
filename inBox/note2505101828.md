# p5.js Web Editor

[GitHub - processing/p5.js-web-editor: The p5.js Editor is a website for creating p5.js sketches, with a focus on making coding accessible and inclusive for artists, designers, educators, beginners, and anyone else! You can create, share, or remix p5.js sketches without needing to download or configure anything.](https://github.com/processing/p5.js-web-editor)

~~ã‚¨ãƒ‡ã‚£ã‚¿éƒ¨åˆ†ã‚’codemirror ã¨ã‹ã«ç½®ãæ›ãˆãŸã„~~

å‹˜é•ã„: `"codemirror": "^5.62.0"` ã ã‹ã‚‰ã€5ç³»ã§ã¯ãªã6ç³»ã«æ›¿ãˆã¦ã¿ã‚‹ã€‚ã¨ã„ã†è¡¨ç¾ãŒé©åˆ‡ã‹ï¼Ÿ


# ãƒªãƒã‚¸ãƒˆãƒªèª¿æŸ»

## ãƒ–ãƒ©ã‚¦ã‚¶ã‚¨ãƒ‡ã‚£ã‚¿ã§è¦‹ãˆã¦ã‚‹ã‚‚ã®

ãƒ–ãƒ©ã‚¦ã‚¶ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§ç™»å ´ã™ã‚‹ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒè¨˜è¿°ã•ã‚Œã¦ã„ã‚‹å ´æ‰€ã¯ã©ã“ã‹ï¼Ÿ

```js
function setup() {
  createCanvas(400, 400);
}

function draw() {
  background(220);
}
```

[p5.js-web-editor/server/domain-objects/createDefaultFiles.js](https://github.com/processing/p5.js-web-editor/blob/develop/server/domain-objects/createDefaultFiles.js "createDefaultFiles.js")


`.html` ã¨ã—ã¦ã„ã‚‹å†…å®¹ã‚‚ã“ã“ã«æ›¸ã‹ã‚Œã¦ãŸ


`createDefaultFiles` ã¨ã—ã¦ã€è¿”ã—ã¦ã„ã‚‹

## `domain-objects/`

- `__test__` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
  - `Project.js` ã‚’`import` ã—ã¦test ã—ã¦ã‚‹
    - `containsRootHtmlFile` , `toModel` , `transformFiles` , `FileValidationError` ã‚’ä½¿ã£ã¦UI ä½œã£ã¦ã‚‹æ„Ÿã˜ï¼Ÿ
    - ä»–ã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰test ã®å®Ÿè£…ã‚’æ¢ã›ã°ã€è¿½ã£ã‹ã‘ã§ãã‚‹ã‹ã‚‚
  - ã¡ã‚ƒã‚“ã¨èª­ã‚ã°å¤±æ•—ã•ã›ã‚‹å‹•ããŒã‚ã‹ã‚‹ã‹ã‚‚ï¼Ÿ
- `Project.js`
  - `Object.entries` ã¨ã‹ã®js ã®`Object` ã—ãã•ç†è§£ã—ã¦ãªã„ã‹å‹‰å¼·ã‹ã€ã€ã€
  - `export function toModel(object)`
    -Â This converts between the public API's Project object properties and a mongoose Project model
    - ã“ã‚Œã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯API ã®Project ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨mongoose ã®Project ãƒ¢ãƒ‡ãƒ«ã‚’å¤‰æ›ã—ã¾ã™ã€‚
      - ãªã‚‹ã»ã©ï¼ŸğŸ¤”
  - `import Project from '../models/project';`
- `createDefaultFiles.js`


### `lodash` ã£ã¦ä½•ã ã£ã‘ï¼Ÿ

#### ã¨ã‚Šã¾ã‚°ã‚°ã‚Š

æ¤œç´¢çµæœã®é©å½“ãªãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—

- [Lodash](https://lodash.com/)
- [ã€JavaScriptã€‘lodashã®ä½¿ã„æ–¹ #JavaScript - Qiita](https://qiita.com/sosomuse/items/a08e28def541c28458a0)
- [Lodashã§ä½¿ãˆã‚‹ä¾¿åˆ©ãªé–¢æ•°ã¨ä»£æ›¿å¯èƒ½ãªJavaScriptã®æ¨™æº–æ©Ÿèƒ½](https://zenn.dev/cti1650/articles/lodash_functions)

#### ä½¿ã‚ã‚Œã¦ã„ã‚‹é–¢æ•°

##### `isPlainObject`

[isPlainObject | Lodash Documentation](https://lodash.com/docs/4.17.15#isPlainObject)

##### `pick`

[pick | Lodash Documentation](https://lodash.com/docs/4.17.15#pick)

### `Object(.entries)`


### `mongoose`

[Mongoose ODM v8.14.2](https://mongoosejs.com/)

MongoDB ğŸ˜‡

## `server/models/project.js`


```js
const projectSchema = new Schema(
  {
    name: {
      type: String,
      default: "Hello p5.js, it's the server",
      maxlength: 128
    },
    user: { type: Schema.Types.ObjectId, ref: 'User' },
    serveSecure: { type: Boolean, default: false },
    files: { type: [fileSchema] },
    _id: { type: String, default: shortid.generate },
    slug: { type: String }
  },
  { timestamps: true }
);
```
`mongoose` ã«ã€`models.Project` ã¦ã®ãŒã‚ã£ã¦ã€ãã‚Œã‹ã€`Schema` ã¨ã—ã¦ã€è¨­å®šã—ãŸã‚‚ã®ã‚’ãƒ–ãƒè¾¼ã‚€ï¼Ÿ


## build 

ãã‚‚ãã‚‚ã€build ã‚’ã—ãŸã‚‰ã€ã©ã®ã‚ˆã†ã«åãå‡ºã•ã‚Œã‚‹ã®ã‹ã‚’ç¢ºèªã—ãŸã„ã€‚

`server` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹ã€‚ã©ã®ã‚ˆã†ãªå‡¦ç†ã ã‹ã‚‰ã€`server` ã¨ãªã‚‹ã®ã‹ï¼Ÿ

ãŒã€ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã«build ã§ããªã„ã‚“ã‚ˆãªã


[p5.js-web-editor/contributor_docs/README.md at develop Â· processing/p5.js-web-editor Â· GitHub](https://github.com/processing/p5.js-web-editor/blob/develop/contributor_docs/README.md)

ã“ã“èª­ã‚ã°ã€ã„ã‚ã„ã‚ã¨åˆ¤æ˜ã™ã‚‹ã‹ãªï¼Ÿ


ä¸€å¿œã€Docker ã‚’ã‚³ãƒ”ãƒšã‚³ãƒãƒ³ãƒ‰ã§å®Ÿè¡Œã§ããŸ

## CodeMirror ã¯ã©ã“ã«ï¼Ÿ


`client/modules/IDE/components/Editor/index.jsx`
[p5.js-web-editor/client/modules/IDE/components/Editor/index.jsx at develop Â· processing/p5.js-web-editor Â· GitHub](https://github.com/processing/p5.js-web-editor/blob/develop/client/modules/IDE/components/Editor/index.jsx)


react ã§ã‚³ãƒã‚³ãƒã™ã‚‹ã®ã­

reactã®ãŠå‹‰å¼·ã‹ãªã


### `components/Editor/index.jsx` ã®æŒ™å‹•


æ›¸ãæ›ã‚ã‚‹çŠ¶æ…‹ã‚’è¦‹ã¤ã‘ãŸã„ã€‚

`constructor(props)` ã§ã€`this.props` ãŒä½•ã‹ã—ã¦ã‚‹ã€‚

[this._cm.on](https://github.com/processing/p5.js-web-editor/blob/c175c1c8d21915b7a0838795cd25bf5f3ab05a96/client/modules/IDE/components/Editor/index.jsx#L191)


`client/modules/IDE/actions/ide.js`

[startSketch | p5.js-web-editor/client/modules/IDE/actions/ide.js at 0f1018089d0f795e55952bdf78a1291ff4937f19 Â· processing/p5.js-web-editor](https://github.com/processing/p5.js-web-editor/blob/0f1018089d0f795e55952bdf78a1291ff4937f19/client/modules/IDE/actions/ide.js#L251)


ã‚¹ã‚¿ãƒ¼ãƒˆã¯ã€ã“ã‚Œã£ã½ã„ã‘ã©ã€æ›´æ–°ã¯ã©ã“ã‚„ã‚ï¼Ÿ


## ï¼ˆã‚„ã¯ã‚Šï¼‰`ifeame` ã‹ã€ã€ã€

[p5.js-web-editor/client/modules/IDE/components/PreviewFrame.jsx at develop Â· processing/p5.js-web-editor Â· GitHub](https://github.com/processing/p5.js-web-editor/blob/develop/client/modules/IDE/components/PreviewFrame.jsx)


react ã‚´ãƒªã‚´ãƒªã‚„ãªã€ã€ã€


ã‚ã¨ã€redux ï¼ˆï¼Ÿï¼‰ã§ã€æ›´æ–°æ™‚ã«ãƒãƒ«ãƒƒã¨æ›¸ãæ›ãˆã‹ï¼Ÿ

## `p5.js` ã‚’è¦‹ã«è¡Œã

ãƒãƒ«ã£ã¨å…¨ä½“ã‚’æ›¸ãæ›ãˆã‚‰ã‚Œã¦ã¯æ•µã‚ãªã„ã®ã§ï¼ˆvanilla ã§æ›¸ãå ´åˆï¼‰ã€
æœ¬ä½“ã§ã€å®Ÿè¡Œã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿ç›´ã™ã®ãŒã‚ã‚‹ã‹ç¢ºèªã€‚


## Docker ã§å®Ÿè¡Œ

[installation.md | p5.js-web-editor/contributor_docs/installation.md at develop Â· processing/p5.js-web-editor](https://github.com/processing/p5.js-web-editor/blob/develop/contributor_docs/installation.md)

ã‚³ãƒãƒ³ãƒ‰ã‚³ãƒ”ãƒšã§å®Ÿè¡Œç¢ºèªã§ããŸã€‚

`previewApp.js` webpack ã§åã„ã¦ï¼ˆï¼Ÿï¼‰ã¦ã€iframe å†…ã§å®Ÿè¡Œã—ã¦ã‚‹ã€‚ã¨æ€ã‚ã‚Œã‚‹ã€‚


## ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã®æ–‡å­—åˆ—ã‚’sketch ã¨ã—ã¦ã‚‹ã¨ã“ã‚ã‚’è¦‹ã¤ã‘ã‚‹

`production` ãƒ“ãƒ«ãƒ‰ã‚’è¿½ã£ã¦ã„ããŸã„ã€‚å¤šåˆ†`prod` ã€‚
`development` ãƒ“ãƒ«ãƒ‰ã§ã¯ã€é–‹ç™ºç”¨ã®ãƒ‘ãƒãƒ«ãŒå‡ºç¾ã™ã‚‹ãŸã‚ã€‚

### `package.json`

å¿…è¦ãªã®ã‚’æŠœãå–ã‚Šã€‚

```json
"scripts": 
    "start:prod": "cross-env NODE_ENV=production node index.js",

    "build": "npm run build:client && npm run build:server && npm run build:examples",
    "build:client": "cross-env NODE_ENV=production webpack --config webpack/config.prod.js",
    "build:server": "cross-env NODE_ENV=production webpack --config webpack/config.server.js",
    "build:examples": "cross-env NODE_ENV=production webpack --config webpack/config.examples.js",
    "fetch-examples:prod": "cross-env NODE_ENV=production node ./dist/fetch-examples.bundle.js",

  },
```


`"build": "npm run build:client && npm run build:server && npm run build:examples",`

### `evaluateExpression` ?

[evaluateExpression.js | p5.js-web-editor/client/utils/evaluateExpression.js at develop Â· processing/p5.js-web-editor Â· GitHub](https://github.com/processing/p5.js-web-editor/blob/develop/client/utils/evaluateExpression.js)





#p5js #editor #js #codemirror #draft #github #docker
